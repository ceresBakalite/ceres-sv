/**
 * @license
 * ceres-sv v1.0.0
 *
 * Minified using terser v5.5.1
 * Original file: ceresbakalite/ceres-sv/repos/csvjs/ceres-sv.js
 *
 * ceresBakalite/ceres-sv is licensed under the MIT License - http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2018 - 2020 Alexander Munro
*/
import{rsc as e}from'../prod/ceres-rsc.js';globalThis.ceres={},globalThis.customElements.define('ceres-sv',class extends HTMLElement{async connectedCallback(){ceres.getImage=t=>e.srcOpen({element:t,type:'image'}),ceres.getSlide=e=>o.get.slide({node:e});const t={},o={};var a;(a=this).src=a.getAttribute('src'),t.defaultCSS='https://ceresbakalite.github.io/ceres-sv/prod/ceres-sv.min.css',t.src=e.ignore(a.src)?null:a.src.trim(),t.css=a.getAttribute('css')||t.defaultCSS,t.srcRoot=!e.ignore(t.src),t.commaCodes=/,|&comma;|&#x2c;|&#44;|U+0002C/g,t.commaSymbol='_&c',t.shadowStyle='',t.node={},t.slide=1,t.cssRoot=e.removeDuplcates(t.css.trim().replace(/,/gi,';').replace(/;+$/g,'').replace(/[^\x00-\xFF]| /g,'').split(';')),function(){const n=e.elementName(a),s=new Map,i={markup:'Media list markup',element:'The element attributes',nodeSearch:'The '+n+' src attribute url is unavailable and there is no node name. Looking for the first occurance of a <template> or <noscript> tagname',properties:'Error: Unable to find the '+n+' document element',list:'Error: Unable to find either the '+n+' document element nor the fallback local template elements',template:'Error: Unable to find the local fallback template element when searching the document body',cache:'Warning: cache response status'};Object.freeze(i),this.instance={hasContent:()=>this.content.properties()?this.content.textList()?this.content.textArray():e.inspect({type:e.error,notification:i.list}):e.inspect({type:e.error,notification:i.properties}),showContent:()=>{this.get.shadow(),this.get.slide({shadow:t.shadow}),this.get.view()}},this.content={properties:()=>{const o=['color','font','padding','top','bottom'],s=['sub','sur'];return(()=>{if(e.ignore(a))return!1;a.id=e.getUniqueId({name:n,range:1e3});const r=n=>{const i=a.getAttribute(n),r='cache'==n||'zoom'==n,l={track:!e.getBoolean(i),fade:!e.getBoolean(i),trace:e.getBoolean(i),loading:i||'auto',name:i||a.id,delay:Number.isInteger(parseInt(i,10))?parseInt(i,10):250};if(l.hasOwnProperty(n))return l[n];if(!i)return!!r;const c='sur'==n?/.surtitle[^&]*?}/i:/.subtitle[^&]*?}/i,d=/(\s+)?:(\s+)?/g,m=i.replace(d,':').split(',').map((e=>e.trim())),p=m[0];if(r)return(()=>{if('cache'==n){const o=m.length>1?m[1].includes('media'):p.includes('media')||null,a=p.includes('media')||e.getBoolean(p);return a&&!e.ignore(o)&&(t.node.cachemedia=o),a}if('zoom'==n)return!/^false$/i.test(p)&&(t.node.clickevent=m.length>1?m[1]:/^true$/i.test(p)?null:p,!e.ignore(t.node.clickevent)||e.getBoolean(p))})();if(!Number.isInteger(parseInt(p))){if(!e.getBoolean(p))return!1;m.length>1&&m.shift()}return'auto'==n?(t.node.autocycle=Number.isInteger(parseInt(m[0]))?parseInt(m[0]):10,t.node.autopause=Number.isInteger(parseInt(m[1]))?parseInt(m[1]):3e3,t.node.autocancel=t.node.autocycle>-1,t.node.fade=t.node.autopause>400,t.node.track='false',!0):(s.includes(n)&&0!=m.length&&m.forEach((a=>{o.includes(a.split(':')[0])&&(o=>{const a=Boolean(o.match(/color:/i))?/color[^&]*?;/i:Boolean(o.match(/font:/i))?/font[^&]*?;/i:Boolean(o.match(/padding:/i))?/padding[^&]*?;/i:Boolean(o.match(/top:/i))?/top[^&]*?;/i:Boolean(o.match(/bottom:/i))?/bottom[^&]*?;/i:null;if(!e.ignore(a)){const e=String(t.shadowStyle.match(c));if(e){const n=e.replace(a,o.replace(d,':')+';');n&&(t.shadowStyle=t.shadowStyle.replace(e,n))}}})(a)})),!0)};return t.node.track=r('track'),t.node.fade=r('fade'),t.node.cache=r('cache'),t.node.trace=r('trace'),t.node.loading=r('loading'),t.node.name=r('name'),t.node.zoom=r('zoom'),t.node.delay=r('delay'),t.node.sur=r('sur'),t.node.sub=r('sub'),t.node.auto=r('auto'),Object.freeze(t.node),t.template=(()=>{if(t.srcRoot)return'undefined';let o=document.getElementById(t.node.name)||null;return e.ignore(o)&&(e.inspect({type:e.notify,notification:i.nodeSearch,logtrace:t.node.trace}),o=document.getElementsByTagName('template')[0]||document.getElementsByTagName('noscript')[0]),o||'undefined'})(),!0})()},textList:()=>t.srcRoot||t.template,textArray:()=>{t.mediaArray=null,e.inspect({type:e.notify,notification:i.element+' ['+e.getProperties(t.node)+']',logtrace:t.node.trace});const o=/\s*\n\s*/g,n=()=>t.srcRoot?a.textContent.replace(o,'\n')||null:(()=>{const a='template'!=e.elementName(t.template)?t.template.textContent:t.template.content.textContent;return e.ignore(a)?e.inspect({type:e.error,notification:i.template+' ['+t.node.name+']'}):this.parseText(a).replace(o,'\n')})();return(()=>{const o=n();return!e.ignore(o)&&(e.inspect({type:e.notify,notification:i.markup+' ['+a.id+(t.srcRoot?' - file name: '+e.fileName(t.src):' - node name: '+t.node.name)+']'+e.newline+o.replaceAll(t.commaSymbol,'&comma;').replace(/&lt;/g,'<').replace(/&gt;/g,'>'),logtrace:t.node.trace}),t.mediaArray=o?o.trim().split('\n'):null,!e.ignore(t.mediaArray))})()}},this.get={shadow:()=>{const o=document.querySelector('#'+a.id);e.clearElement(o),o.attachShadow({mode:'open'}),t.shadow=o.shadowRoot,this.compose.style(),this.compose.body(),t.node.auto||e.setSwipe({node:t.shadow.querySelector('div.slideview-body > div.slideview-media')},(e=>{const o=e.action?e.right:e.left;t.slide=t.slide+=o,this.get.slide({shadow:t.shadow})}),{left:-1,right:1})},slide:o=>{e.ignore(o.shadow)&&(o.shadow=e.ignore(o.node)?t.shadow:(e=>{const o=e.getRootNode().host,a=document.querySelector('#'+o.id).shadowRoot,n=a.querySelector('div.slideview-media > div.active');return t.slide=Number.parseInt(n.id.replace('svm',''),10),s.set('left',t.slide-1),s.set('right',t.slide+1),s.set('stud',Number.parseInt(e.id.replace('svt',''),10)),t.slide=s.get(e.className),a})(o.node));const a=o.shadow.querySelectorAll('div.slideview-media > div.slide'),n=o.shadow.querySelectorAll('div.slideview-track > span.stud'),i=o.shadow.querySelector('div.slideview-media > div.active'),r=o.shadow.querySelector('div.slideview-track > span.enabled');t.slide=e.ignore(o.autoslide)?t.slide<1?a.length:t.slide>a.length?1:t.slide:o.autoslide;const l=t.slide-1;e.ignore(a[l])||(i&&i.classList.replace('active','none'),r&&(r.className='stud'),a[l].classList.replace('none','active'),n[l].className='stud enabled')},view:()=>{const a=()=>{const e=t.shadow.querySelectorAll('div.slideview-media > div.slide'),a=t.node.autocancel&&t.node.autocycle>-1?t.mediaArray.length*t.node.autocycle:0;let n=0,s=1;const i=setInterval((()=>{s=s<1?e.length:s>e.length?1:s,(t.node.autocancel?n===a||(s++,n++,0):(s++,0))&&clearInterval(i),o.get.slide({autoslide:s-1})}),t.node.autopause)};setTimeout((()=>{t.node.auto&&setTimeout((()=>{a()}),t.node.delay),o.setDisplay.show()}),t.node.delay),t.node.cache&&(()=>{if(!globalThis.hasOwnProperty('caches'))return;const o=t.srcRoot?t.src.split():Array.from(''),a=n+'-cache',s=[];t.node.cachemedia&&t.mediaArray.forEach((t=>{let o=t.split(',');e.ignore(o[0])||s.push(o[0].trim())})),e.removeDuplcates(s.concat(o.concat(t.cssRoot.concat([import.meta.url])))).forEach((o=>{fetch(o).then((n=>(n.ok||e.inspect({type:e.warn,notification:i.cache+' ['+n.status+'] - '+o,logtrace:t.node.trace}),caches.open(a).then((e=>e.put(o,n))))))}))})(),e.inspect({type:e.notify,notification:t.shadow,logtrace:t.node.trace})}},this.compose={style:()=>{const e=document.createElement('style');e.className='slideview-style',e.insertAdjacentHTML('beforeend',t.shadowStyle),t.shadow.appendChild(e)},body:()=>{const o=()=>e.ignore(m.ar[0])?null:m.ar[0].trim(),a=()=>e.ignore(m.ar[1])?null:m.ar[1].trim().replaceAll(t.commaSymbol,','),n=()=>t.node.sur?e.ignore(m.ar[2])?m.index+' / '+t.mediaArray.length:m.ar[2].trim().replaceAll(t.commaSymbol,','):null,s=t.node.zoom?e.ignore(t.node.clickevent)?'ceres.getImage(this);':t.node.clickevent:null,i='ceres.getSlide(this)',r=this.getClass('slide'),l=document.createElement('div');l.className='slideview-body';const c=document.createElement('div');c.className='slideview-media',l.appendChild(c);const d=document.createElement('div');d.className=this.getClass('slideview-track'),l.appendChild(d);const m={index:0,ar:[]};t.mediaArray.forEach((i=>{m.ar=i.split(',');const l=document.createElement('div');l.className=r,l.id='svm'+ ++m.index,c.appendChild(l),t.node.sur&&e.composeElement({nodeType:'div',parent:l,markup:n()},{class:'surtitle fade'}),!e.ignore(m.ar[0])&&e.isVideo(m.ar[0])?(l.classList.remove('zoom'),e.composeElement({nodeType:'video',parent:l,src:o(),type:e.mediaType(m.ar[0])},{width:'100%',autoplay:!0})):e.composeElement({nodeType:'img',parent:l},{class:'slide',onclick:s,src:o(),alt:a(),loading:Boolean(t.node.loading.match(/lazy|eager|auto/i))?t.node.loading:'auto'}),t.node.sub&&e.composeElement({nodeType:'div',parent:l,markup:t.node.sub?a():null},{class:'subtitle fade'})})),t.mediaArray.length>1&&(e.composeElement({nodeType:'a',parent:c},{class:this.getClass('left'),onclick:i}),e.composeElement({nodeType:'a',parent:c},{class:this.getClass('right'),onclick:i})),t.mediaArray.forEach(((t,o)=>{e.composeElement({nodeType:'span',parent:d},{class:'stud',id:'svt'+ ++o,onclick:i})})),t.shadow.appendChild(l)}},this.setDisplay={hide:()=>{a.style.visibility='hidden',a.style.display='none'},show:()=>{a.style.removeProperty('display'),a.style.removeProperty('visibility'),0===a.style.length&&a.removeAttribute('style')}},this.getClass=e=>'slide'!=e?t.node.track&&(t.node.auto||t.mediaArray.length<2)?e+=' none':e:(t.node.zoom&&(e+=' zoom'),t.node.fade&&(e+=' fade'),e+' none'),this.parseFile=o=>{const a=e.fileType(t.src,'json')?this.parseJSON(o):e.fileType(t.src,'csv')?this.parseJSON(e.parseCSV(o,{json:!0,nodes:['url','sub','sur'],commaCodes:t.commaCodes,commaSymbol:t.commaSymbol})):o;return this.parseText(a)},this.parseText=o=>e.softSanitize(o.replace(/\\,|&comma;|&#x2c;|&#44;|U+0002C/g,t.commaSymbol).replace(/^\s*?<template(.*?)>|<\/template>\s*?$/,'')).trim(),this.parseJSON=e=>{const o=JSON.parse(e);let a='';return o.forEach((e=>{a+=e.url+(e.sub?', '+e.sub.replace(t.commaCodes,t.commaSymbol):'')+(e.sur?', '+e.sur.replace(t.commaCodes,t.commaSymbol):'')+'\n'})),a},Object.seal(o)}.call(o),o.setDisplay.hide(),t.srcRoot&&this.insertAdjacentHTML('afterbegin',o.parseFile(await(await fetch(t.src)).text()));for(let o of t.cssRoot)t.shadowStyle+=e.softSanitize(await(await fetch(o)).text());o.instance.hasContent()&&o.instance.showContent()}});